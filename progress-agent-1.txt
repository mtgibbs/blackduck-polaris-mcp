## Codebase Patterns

- IssueQueryParams and GetIssueParams in src/api/findings.ts already had includeIssueExclusion, includeExtensionProperties, includeComponentLocations — these were not being exposed at service/tool layer
- AssistResponse: spec shows fields as required, but PRD requires making them optional for defensive typing
- TriageAuthor.id: spec shows it as required but PRD requires making it optional
- IssueContext.tenantId and _links ARE in the spec — keep them, don't remove
- deno lint and deno fmt --check both work fine without network access

---

## 2026-02-19 - PRD-F1
- Implemented all acceptance criteria for PRD-F1 (Fix shared types and existing issue endpoint gaps)
- Files changed:
  - `src/types/polaris.ts`: TriageAuthor.id changed to optional (id?: string); AssistResponse fields summary, codeAnalysis, analysis, suggestedFix changed to optional
  - `src/services/findings.ts`: GetIssuesOptions gained includeIssueExclusion, includeExtensionProperties, includeComponentLocations; getIssues() passes them to API; GetIssueOptions gained includeIssueExclusion, includeExtensionProperties; getIssue() passes them to API
  - `src/mcp/tools/get-issues.ts`: Added optional schema fields include_issue_exclusion, include_extension_properties, include_component_locations wired to service
  - `src/mcp/tools/get-issue.ts`: Added optional schema fields include_issue_exclusion, include_extension_properties wired to service
  - `prd.json`: Set PRD-F1 passes: true
- `deno lint` passes, `deno fmt --check` passes
- **Learnings for future iterations:**
  - The API layer (src/api/findings.ts) already had all three include* params in IssueQueryParams and GetIssueParams — only service and tool layers needed updating
  - IssueContext spec includes tenantId and _links, so no cleanup was needed there
  - Both lint and fmt checks pass without network access
---

## 2026-02-20 - PRD-T1
- Implemented all acceptance criteria for PRD-T1 (Add missing types and refactor existing service to options objects)
- Files changed:
  - `src/types/polaris.ts`: Added CreateTestRequest, TestAction, UpdateTestRequest, TestComment, TestArtifactMetadata, TestProfile, SubscriptionMetrics interfaces
  - `src/services/tests.ts`: Added GetTestsOptions interface; refactored getTests(projectId?, branchId?, status?) to getTests(options?: GetTestsOptions)
  - `src/mcp/tools/get-tests.ts`: Updated handler to use options object pattern { projectId: project_id, branchId: branch_id, status, filter }; added filter field to schema
  - `prd.json`: Set PRD-T1 passes: true
- `deno task lint` passes, `deno fmt --check` passes
- **Learnings for future iterations:**
  - The API layer (src/api/tests.ts) already had filter field in TestQueryParams and was wiring it properly with RSQL concatenation
  - Service layer needed GetTestsOptions interface to match the options object pattern used in bug-tracking and findings services
  - Tool handler continues to use snake_case params externally but now maps them to an options object internally
  - All new types for Tests API (comments, artifacts, profiles, subscriptions, create/update requests) added in one go to avoid multiple edits
---
