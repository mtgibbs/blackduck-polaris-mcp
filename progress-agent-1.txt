## Codebase Patterns

- IssueQueryParams and GetIssueParams in src/api/findings.ts already had includeIssueExclusion, includeExtensionProperties, includeComponentLocations — these were not being exposed at service/tool layer
- AssistResponse: spec shows fields as required, but PRD requires making them optional for defensive typing
- TriageAuthor.id: spec shows it as required but PRD requires making it optional
- IssueContext.tenantId and _links ARE in the spec — keep them, don't remove
- deno lint and deno fmt --check both work fine without network access
- const declarations with long string values: deno fmt wraps at 100 chars; if a constant assignment fits on one line within 100 chars, do NOT split across two lines — deno fmt will collapse it back to one line anyway and fail the check

---

## 2026-02-19 - PRD-F1
- Implemented all acceptance criteria for PRD-F1 (Fix shared types and existing issue endpoint gaps)
- Files changed:
  - `src/types/polaris.ts`: TriageAuthor.id changed to optional (id?: string); AssistResponse fields summary, codeAnalysis, analysis, suggestedFix changed to optional
  - `src/services/findings.ts`: GetIssuesOptions gained includeIssueExclusion, includeExtensionProperties, includeComponentLocations; getIssues() passes them to API; GetIssueOptions gained includeIssueExclusion, includeExtensionProperties; getIssue() passes them to API
  - `src/mcp/tools/get-issues.ts`: Added optional schema fields include_issue_exclusion, include_extension_properties, include_component_locations wired to service
  - `src/mcp/tools/get-issue.ts`: Added optional schema fields include_issue_exclusion, include_extension_properties wired to service
  - `prd.json`: Set PRD-F1 passes: true
- `deno lint` passes, `deno fmt --check` passes
- **Learnings for future iterations:**
  - The API layer (src/api/findings.ts) already had all three include* params in IssueQueryParams and GetIssueParams — only service and tool layers needed updating
  - IssueContext spec includes tenantId and _links, so no cleanup was needed there
  - Both lint and fmt checks pass without network access
---

## 2026-02-19 - PRD-TL1
- Implemented foundation for Tools API (no MCP tools, just API/service/types layer)
- Files changed:
  - `src/types/polaris.ts`: Added PolarisTool, DownloadDescriptor, MappedTool, ToolVersionMapping, CompatibleToolVersions, ToolVersionMatrix, ToolVersionSetting, CreateToolVersionSettingRequest interfaces
  - `src/api/tools.ts`: Created with 8 media type constants and 9 API functions (getTools, getTool, getDownloadDescriptor, getToolLicense, getVersionMapping, getVersionMatrix, createVersionSetting, getVersionSettings, getVersionSettingsByContext, updateVersionSetting, deleteVersionSetting)
  - `src/services/tools.ts`: Created service layer wrapping all API functions with typed options interfaces
  - `src/services/index.ts`: Added `export * from './tools.ts'`
  - `prd.json`: Set PRD-TL1 passes: true
- `deno task check` passes, `deno task lint` passes, `deno fmt --check` passes
- **Learnings for future iterations:**
  - deno fmt collapses single-assignment const values to one line if they fit in 100 chars; don't manually break them or fmt --check will fail
  - The Tools API service scaffolding is now available for PRD-TL2, TL3, TL4 to add MCP tools
---
