## Codebase Patterns

- IssueQueryParams and GetIssueParams in src/api/findings.ts already had includeIssueExclusion, includeExtensionProperties, includeComponentLocations — these were not being exposed at service/tool layer
- AssistResponse: spec shows fields as required, but PRD requires making them optional for defensive typing
- TriageAuthor.id: spec shows it as required but PRD requires making it optional
- IssueContext.tenantId and _links ARE in the spec — keep them, don't remove
- deno lint and deno fmt --check both work fine without network access
- Services use options object pattern (not positional args) for all functions
- Tool files: schema is plain object of Zod types (NOT wrapped in z.object()), handler destructures args directly
- All tools have annotations: { readOnlyHint: true/false, openWorldHint: true } (destructive also add destructiveHint: true)
- `deno task check` type-checks agent.ts entry point only; all downstream files are covered

---

## 2026-02-19 - PRD-F1
- Implemented all acceptance criteria for PRD-F1 (Fix shared types and existing issue endpoint gaps)
- Files changed:
  - `src/types/polaris.ts`: TriageAuthor.id changed to optional (id?: string); AssistResponse fields summary, codeAnalysis, analysis, suggestedFix changed to optional
  - `src/services/findings.ts`: GetIssuesOptions gained includeIssueExclusion, includeExtensionProperties, includeComponentLocations; getIssues() passes them to API; GetIssueOptions gained includeIssueExclusion, includeExtensionProperties; getIssue() passes them to API
  - `src/mcp/tools/get-issues.ts`: Added optional schema fields include_issue_exclusion, include_extension_properties, include_component_locations wired to service
  - `src/mcp/tools/get-issue.ts`: Added optional schema fields include_issue_exclusion, include_extension_properties wired to service
  - `prd.json`: Set PRD-F1 passes: true
- `deno lint` passes, `deno fmt --check` passes
- **Learnings for future iterations:**
  - The API layer (src/api/findings.ts) already had all three include* params in IssueQueryParams and GetIssueParams — only service and tool layers needed updating
  - IssueContext spec includes tenantId and _links, so no cleanup was needed there
  - Both lint and fmt checks pass without network access
---

## 2026-02-19 - PRD-BT1
- Implemented all acceptance criteria for PRD-BT1 (Add missing types and expose tools for already-implemented API functions)
- Files changed:
  - `src/types/polaris.ts`: Added CreateBugTrackingConfigRequest, UpdateBugTrackingConfigRequest, TestConnectionResult, CreateProjectMappingRequest, UpdateProjectMappingRequest, ExportCommentRequest interfaces
  - `src/services/bug-tracking.ts`: Added GetLinkedIssuesOptions interface + getLinkedIssues(options) wrapper; Added GetLinkedIssueOptions interface + getLinkedIssue(options) wrapper (converted from positional args to options pattern)
  - `src/mcp/tools/get-external-issue-types.ts`: New tool get_external_issue_types
  - `src/mcp/tools/get-linked-issues.ts`: New tool get_linked_issues
  - `src/mcp/tools/get-linked-issue.ts`: New tool get_linked_issue
  - `src/mcp/tools/index.ts`: Registered all three new tools
  - `prd.json`: Set PRD-BT1 passes: true
- `deno task check` passes, `deno task lint` passes, `deno fmt --check` passes
- **Learnings for future iterations:**
  - The existing getLinkedIssues/getLinkedIssue in services used positional args (not options objects) — PRD-BT1 required converting to options pattern
  - All types for subsequent PRD-BT2–BT5 stories are now defined in polaris.ts
  - services/index.ts uses export * so no changes needed there to expose new service functions
---
